****
# Описание кейса:

Существует некий магический портал, который открывает путь между мирами. Главный показатель портала - `Гармония Бессмертия`, это некий числовой коэффициент, который демонстрирует степень изношенности портала. Как только Гармония достигает критического уровня, магия портала начинает угасать и портал может разрушиться.
****
# Постановка задачи:

Предсказать изменения `Гармонии Бессмертия`, чтобы успеть вмешаться до того, как портал разрушится, и сохранить этот древний путь между мирами для будущих поколений

****
# Описание данных:
`Вектор мощи` -
    Позиция магического механизма, управляющего интенсивностью перехода через портал

`Скорость перехода через портал` -
  Скорость, с которой портал перемещает объект через пространство

`Приток силы потока` -
  Поток магической силы, текующий через ядиро портала, обеспечивая его стабильную работу

`Ритм магического ядра` -
  Число оборотов магического ядра портала в минуту

`Поток энергий` -
  Число оборотов генератора эфира, преобразующего внешнюю энергию в магическую

`Сила левого потока` -
  Мощность магического потока, текущего через левую сторону портала, поддерживая его баланс

`Сила правого потока` -
  Мощность магического потока, текущего через правую сторону портала, обеспечивая равномерное распределение энергии

`Пламя стихий` -
  Температура магической энергии, исходящей из высокого магического источника портала, в градусах Цельсия

`Температура вдоха истока` -
  Температура воздуха, входящего в магический ускоритель портала, в градусах Цельсия

`Температура выдоха истока` -
  Температура воздуха, исходящего в магический ускоритель портала, в градусах Цельсия

`Приток давления выдоха истока` -
  Давление магического потока на выходе из магического источника высокого давления

`Давление вдоха истока` -
  Давление воздуха, входящего в магический ускоритель

`Давление выдоха истока` -
  Давление воздуха, исходящего из магического ускорителя 

`Древний ветер` -
  Давление древней магической энергии, покидающей портал в виде выхлопного потока 

`Печать чародея` -
  Параметр управления магическим впрыском в сердце портала, выраженный в процентах

`Эмульсия истока`
  Количество магического топлива, подпитывающего портал

`Дыхание истока`
  Коэффициент, отображающий степень угасания магического ускорителя

`Гармония Бессмертия - таргет`
  Коэффициент, указывающий на состояние магического ядра портала и его стабильность, требующий магического восстановления в случае снижения


****
# Выводы по проделанной работе:

Основные цели:

- Предсказание состояние `Гармонии Бессмертия`, работа с мультиколлениарностью и избыточностью признаков

Для решения задачи я применил следующие методы:

- Анализ данных вручную
- Метод PCA
- Метод обратного отбора признаков

Ключевые этапы работы:

1. Предварительная обработка данных

На начальном этапе был осуществлён первичный анализ данных. С его помощью я смог найти и удалить неинформативные колонки, которые не предоставляли значимой информации для последующего анализа. Так же, перевел все категориальные колонки в вещественные

2. Анализ корреляций

Следующим шагом стал корреляционный анализ, направленный на выявление зависимости между признаками. Результаты показали наличие высокой мультиколлинеарности между признаками, что свидетельствовало о наличии двух ключевых проблем: избыточности признаков и их линейной зависимости.

3. Визуальная оценка и проверка гипотез

Для более глубокого понимания структуры данных был проведён визуальный анализ, включая построение графиков распределения значений признаков и проверку гипотезы о равномерности распределения. Был выполнен попарный анализ данных, увидели, как данные взаимодействуют друг с другом на графиках 

4. Преобразования признаков

Были применены нелинейные преобразования к исходным признакам, такие как умножение, деление и взятие синуса. Эти операции позволили создавать новые признаки, которые учитывали взаимодействия между исходными данными и снижали влияние мультиколлинеарности.

5. Оптимизация набора признаков

Благодаря созданию новых признаков стало возможным исключить из анализа старые, избыточные признаки. Это существенно сократило размерность пространства признаков.

6. Визуальная оценка зависимости целевой переменной от признаков

Мы оценили, как новые признаки влияют на целевую переменную, а также проанализировали их корреляцию с таргетом.

7. Построение моделей и оценка результатов

Мы взяли две модели: градиентный бустинг (CatBoost) и линейная регрессия. Оценили важность признаков для модели CatBoost и проанализировали результаты на различных метриках. Модель CatBoost продемонстрировала способность выявлять сложные взаимосвязи между признаками и целевой переменной, что подтверждается высоким показателем коэффициента детерминации (R²). Эта модель подтвердила значимость каждого нового признака для прогнозирования зависимости между колонками и целевой величиной. Линейная регрессия показала хорошие результаты по метрикам средней абсолютной ошибки (MAE) и среднеквадратичной ошибки (RMSE), однако её коэффициент детерминации оказался равен нулю, что указывает на неспособность модели объяснять вариацию целевой переменной.

8. Подбор гиперпараметров

Был осуществлен подбор гиперпараметров для модели CatBoost. Подбор осуществлялся с помощью Байесовской оптимизации. Данная операция заняла достаточно времени и немного улучшила результаты.

9. Решение через метод PCA

Попробовали решить задачу другим путем, использовав метод главных компонент. Сжали признаковое пространство до 3-х признаков, посмотрели, как влияют сжатые признаки на таргет и обучили на них модель CatBoost. Посмотрев результаты на метриках, сделали вывод, что данное решение оказалось слабее, чем ранее построенная модель CatBoost на аналитическом решении. Однако, с его помощью мы смогли решить проблему избыточности признаков и мультиколлениарности.


10. Решение с помощью метода обратного отбора признаков

В этом случае, мы подошли к решению задачи с помощью алгоритма обратного отбора признаков. Использовали исходный датафрейм, задачи значение порога для отсечения признаков и обучили CatBoost. По итогу модель удалила 4 признака, которые изначально не несли никакой информативности. Модель показала отличные результаты на всех метриках, но не решила проблему мультиколлениарности и избыточности признаков


  ****


В файле `data_GPN_CUP_inresh.csv` находятся данные

`history.pdf` - Постановка задачи, описание данных и рекомендации по работе от организаторов

`solution` - Мое решение. В файле присутсвует оглавление и много комментариев, которые помогут понять ход моих мыслей по ходу решения. 
